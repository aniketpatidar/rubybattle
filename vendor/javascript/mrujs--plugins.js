class CableCar{constructor(e,{mimeType:n}={}){this.cableReady=e;this.mimeType=null!==n&&void 0!==n?n:"text/vnd.cable-ready.json";this.boundPerform=this.perform.bind(this)}get name(){return"CableCar"}initialize(){const e=window.mrujs.mimeTypes.any;window.mrujs.registerMimeTypes([{shortcut:"any",header:`${this.mimeType}, ${e}`},{shortcut:"cablecar",header:this.mimeType}])}connect(){document.addEventListener("ajax:beforeNavigation",this.boundPerform)}disconnect(){document.removeEventListener("ajax:beforeNavigation",this.boundPerform)}perform(e){const n=e.detail.fetchResponse;if(null!=(null===n||void 0===n?void 0:n.contentType)&&this.isCableReadyResponse(n.contentType)){e.preventDefault();n.json().then((e=>{this.cableReady.perform(e)})).catch((e=>{console.error(e)}))}}isCableReadyResponse(e){return Boolean(e.includes(this.mimeType))}}function JsErb(){const e="JsErb";return{name:e,initialize:initialize$1,connect:connect$2,disconnect:disconnect$2}}function initialize$1(){const{script:e,any:n}=window.mrujs.mimeTypes;window.mrujs.registerMimeTypes([{shortcut:"any",header:`${e}, ${n}`}])}function connect$2(){document.addEventListener("ajax:complete",injectScriptIntoHead)}function disconnect$2(){document.removeEventListener("ajax:complete",injectScriptIntoHead)}function injectScriptIntoHead(e){var n,t,o,i;if(!isJavascriptResponse(null===(t=null===(n=e.detail)||void 0===n?void 0:n.fetchResponse)||void 0===t?void 0:t.contentType))return;const r=document.createElement("script");const c=window.mrujs.cspNonce();null!=c&&r.setAttribute("nonce",c);window.mrujs.enableElement(e);null===(i=null===(o=e.detail)||void 0===o?void 0:o.fetchResponse)||void 0===i?void 0:i.text().then((n=>{var t,o;r.text=n;null===(o=null===(t=document.head.appendChild(r))||void 0===t?void 0:t.parentNode)||void 0===o?void 0:o.removeChild(r);const{element:i,fetchRequest:c,fetchResponse:s}=e.detail;window.mrujs.navigationAdapter.navigate(i,c,s)})).catch((e=>console.error(e)))}function isJavascriptResponse(e){return null!=e&&Boolean(e.match(/\b(?:java|ecma)script\b/))}function MrujsTurbo(){return{name:"MrujsTurbo",initialize:initialize,connect:connect$1,disconnect:disconnect$1}}const e="text/vnd.turbo-stream.html";function initialize(){const n=window.mrujs.mimeTypes.any;window.mrujs.registerMimeTypes([{shortcut:"any",header:`${e}, ${n}`},{shortcut:"turbo",header:e}])}function connect$1(){document.addEventListener("ajax:beforeNavigation",handleTurboStream)}function disconnect$1(){document.removeEventListener("ajax:beforeNavigation",handleTurboStream)}function handleTurboStream(e){const n=e.detail.fetchResponse;if(null!=n&&isTurboResponse(n.contentType)){e.preventDefault();n.html().then((e=>{window.Turbo.renderStreamMessage(e)})).catch((e=>{console.error(e)}))}}function isTurboResponse(n){return Boolean(n.includes(e))}function Shoelace(){return{name:"Shoelace",connect:connect,disconnect:disconnect}}function connect(){document.addEventListener("sl-submit",shoelaceFormListener)}function disconnect(){document.removeEventListener("sl-submit",shoelaceFormListener)}function shoelaceFormListener(e){var n,t,o;const i=e.target;const r=e.detail.formData;const c=i.getAttribute("action");let s=i.getAttribute("method");if(null==c){console.warn("No 'action' attribute on your Shoelace form. Aborting...");return}null==s&&(s="get");const mrujs=()=>window.mrujs;null===(o=null===(t=null===(n=mrujs())||void 0===n?void 0:n.fetch(c,{element:i,dispatchEvents:true,method:s,body:mrujs().urlEncodeFormData(r)}))||void 0===t?void 0:t.then((()=>{})))||void 0===o?void 0:o.catch((e=>console.warn(e)))}export{CableCar,JsErb,MrujsTurbo,Shoelace};

